# Description: The Bzip2 package contains programs for compressing and decompressing files. Compressing text files with bzip2 yields a much better compression percentage than with the traditional gzip
# URL: http://www.bzip.org/
# Maintainer: Julian Seward, jseward at bzip dot org
# Packager: pierre^
source=(http://www.bzip.org/$version/bzip2-$version.tar.gz \
http://www.linuxfromscratch.org/patches/lfs/development/bzip2-$version-install_docs-1.patch)
PKGMK_GROUPS=(devel doc man)
build() {

cd bzip2-$version

patch -Np1 -i ../bzip2-$version-install_docs-1.patch
sed -i 's@\(ln -s -f \)/bin/@\1@' Makefile
sed -i "s@(PREFIX)/man@(PREFIX)/usr/share/man@g" Makefile

make -f Makefile-libbz2_so
make clean

make

make PREFIX=$PKG/usr install

mkdir -pv $PKG/{bin,lib}
cp -v bzip2-shared $PKG/bin/bzip2
cp -av libbz2.so* $PKG/lib
ln -sv ../../lib/libbz2.so.1.0 $PKG/usr/lib/libbz2.so
rm -v $PKG/usr/bin/{bunzip2,bzcat,bzip2}
ln -sv bzip2 $PKG/bin/bunzip2
ln -sv bzip2 $PKG/bin/bzcat
}
